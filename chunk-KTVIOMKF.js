import{a as Q}from"./chunk-HOD3NHHL.js";import{a as L}from"./chunk-ILLBSOCN.js";import"./chunk-XAZLOLJU.js";import{a as z}from"./chunk-2ZVJAC5A.js";import{k as R,m as B,n as w}from"./chunk-R3XHQFXV.js";import{a as x}from"./chunk-OTWRRM26.js";import{a as V,b as j,c as N,d as J,e as M}from"./chunk-S4B2MDIS.js";import{Hb as A,La as S,Lb as O,O as D,Sa as i,T as v,Ta as t,Ua as C,X as y,Xa as E,Ya as h,bb as b,cb as I,da as d,db as k,ea as p,eb as F,fb as r,jb as T,wa as f,xa as g}from"./chunk-XBW5HTEE.js";var U=(()=>{class c{constructor(e,n,a){this.storageService=e,this.studentService=n,this.toastService=a}exportDataToJson(){try{let e=this.storageService.getStudents(),n=JSON.stringify(e,null,2),a=`data:application/json;charset=utf-8,${encodeURIComponent(n)}`,o="student_records.json",s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",o),s.click(),this.toastService.show({title:"Data Exported",description:"All student records have been exported to JSON"})}catch(e){console.error("Failed to export data:",e),this.toastService.show({title:"Export Failed",description:"Could not export student records",variant:"destructive"})}}exportDataToCsv(){try{let e=this.storageService.getStudents(),n=["Name","Branch","Class","Roll No","Honours Degree","Email"],a=e.map(m=>[m.name,m.branch,m.class,m.rollNo.toString(),m.honoursDegree,m.email]),o=[n.join(","),...a.map(m=>m.join(","))].join(`
`),s=new Blob([o],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),u=document.createElement("a");u.setAttribute("href",l),u.setAttribute("download","student_records.csv"),u.click(),this.toastService.show({title:"CSV Exported",description:"Student records exported to CSV format"})}catch(e){console.error("Failed to export CSV:",e),this.toastService.show({title:"Export Failed",description:"Could not export student records to CSV",variant:"destructive"})}}importDataFromJson(e){return new Promise((n,a)=>{let o=new FileReader;o.onload=s=>{try{let l=s.target?.result,u=JSON.parse(l);if(!Array.isArray(u)){this.toastService.show({title:"Import Failed",description:"Invalid data format. Expected an array of students.",variant:"destructive"}),n(!1);return}if(!u.every(_=>this.validateStudentData(_))){this.toastService.show({title:"Import Failed",description:"Invalid student data format.",variant:"destructive"}),n(!1);return}this.storageService.clearAllData(),u.forEach(_=>{this.storageService.addStudent(_)}),this.studentService.loadStudents(),this.toastService.show({title:"Import Successful",description:`${u.length} student records imported`}),n(!0)}catch(l){console.error("Failed to import data:",l),this.toastService.show({title:"Import Failed",description:"Could not import student records",variant:"destructive"}),n(!1)}},o.onerror=()=>{this.toastService.show({title:"Import Failed",description:"Error reading the file",variant:"destructive"}),n(!1)},o.readAsText(e)})}validateStudentData(e){return e&&typeof e.id=="string"&&typeof e.name=="string"&&typeof e.branch=="string"&&typeof e.class=="string"&&typeof e.rollNo=="number"&&typeof e.honoursDegree=="string"&&typeof e.email=="string"&&typeof e.createdAt=="string"&&typeof e.updatedAt=="string"}static{this.\u0275fac=function(n){return new(n||c)(v(B),v(w),v(x))}}static{this.\u0275prov=D({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();var W=["fileInput"],ne=(()=>{class c{constructor(e,n,a,o){this.themeService=e,this.studentService=n,this.toastService=a,this.storageManager=o,this.students=[],this.showClearDialog=!1}ngOnInit(){this.studentService.students$.subscribe(e=>{this.students=e})}handleThemeChange(e){let n=e.target;this.themeService.setTheme(n.checked?"dark":"light")}exportAllDataJson(){this.storageManager.exportDataToJson()}exportAllDataCsv(){this.storageManager.exportDataToCsv()}handleFileSelect(e){let n=e.target;if(n.files&&n.files.length>0){let a=n.files[0],o=5*1024*1024;if(a.size>o){this.toastService.show({title:"Error",description:"File size exceeds the limit (5MB)",variant:"destructive"}),this.resetFileInput();return}if(!a.name.toLowerCase().endsWith(".json")){this.toastService.show({title:"Error",description:"Only JSON files are supported",variant:"destructive"}),this.resetFileInput();return}this.storageManager.importDataFromJson(a).then(()=>{this.resetFileInput()}).catch(s=>{console.error("Import error:",s),this.resetFileInput()})}}resetFileInput(){this.fileInput&&(this.fileInput.nativeElement.value="")}openClearDialog(){this.showClearDialog=!0}cancelClearDialog(){this.showClearDialog=!1}clearAllData(){this.studentService.clearAllData(),this.showClearDialog=!1}onAlertDialogOpenChange(e){this.showClearDialog=e}static{this.\u0275fac=function(n){return new(n||c)(g(Q),g(w),g(x),g(U))}}static{this.\u0275cmp=y({type:c,selectors:[["app-settings"]],viewQuery:function(n,a){if(n&1&&b(W,5),n&2){let o;I(o=k())&&(a.fileInput=o.first)}},standalone:!0,features:[T],decls:84,vars:5,consts:[["fileInput",""],[1,"container","max-w-6xl","mx-auto","px-4","py-8","page-transition"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","mb-2"],[1,"text-muted-foreground"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["className","glass-card"],[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"space-y-0.5"],["htmlFor","dark-mode"],[1,"text-sm","text-muted-foreground"],[1,"relative","inline-flex","h-6","w-11","items-center","rounded-full","bg-muted"],["type","checkbox","id","dark-mode",1,"peer","sr-only",3,"change","checked"],[1,"absolute","inset-y-0","start-0","flex","h-6","w-6","items-center","justify-center","rounded-full","bg-background","transition-all","peer-checked:start-5"],[1,"space-y-2"],[1,"grid","grid-cols-2","gap-2","mt-2"],["variant","outline","className","flex items-center gap-2",3,"onClick","disabled"],[1,"border-border","my-4"],["type","file","accept",".json",1,"hidden",3,"change"],["variant","outline","className","w-full mt-2 flex items-center gap-2",3,"onClick"],["className","text-destructive"],["variant","destructive","className","w-full mt-2 flex items-center gap-2",3,"onClick"],["className","glass-card md:col-span-2"],[1,"space-y-4"],[1,"flex","items-start","gap-4"],[1,"text-primary","flex-shrink-0","mt-1","text-2xl"],[1,"text-lg","font-semibold"],[1,"text-sm","text-muted-foreground","mb-2"],["title","Are you absolutely sure?","description","This will permanently delete all student records from your browser storage. This action cannot be undone and your data will be lost.","confirmText","Yes, clear all data","cancelText","Cancel","confirmVariant","destructive",3,"onConfirm","onCancel","openChange","open","glassEffect"]],template:function(n,a){if(n&1){let o=E();i(0,"div",1)(1,"div",2)(2,"h1",3),r(3,"Settings"),t(),i(4,"p",4),r(5," Configure application preferences "),t()(),i(6,"div",5)(7,"app-card",6)(8,"app-card-header")(9,"app-card-title"),r(10,"Appearance"),t(),i(11,"app-card-description"),r(12," Customize how the application looks "),t()(),i(13,"app-card-content",7)(14,"div",8)(15,"div",9)(16,"app-label",10),r(17,"Dark Mode"),t(),i(18,"p",11),r(19," Toggle between light and dark theme "),t()(),i(20,"div",12)(21,"input",13),h("change",function(l){return d(o),p(a.handleThemeChange(l))}),t(),C(22,"span",14),t()()()(),i(23,"app-card",6)(24,"app-card-header")(25,"app-card-title"),r(26,"Data Management"),t(),i(27,"app-card-description"),r(28," Export or import your data "),t()(),i(29,"app-card-content",7)(30,"div",15)(31,"app-label"),r(32,"Export Data"),t(),i(33,"p",11),r(34," Download student records as a file "),t(),i(35,"div",16)(36,"app-button",17),h("onClick",function(){return d(o),p(a.exportAllDataJson())}),i(37,"span"),r(38,"\u{1F4E5}"),t(),r(39," Export as JSON "),t(),i(40,"app-button",17),h("onClick",function(){return d(o),p(a.exportAllDataCsv())}),i(41,"span"),r(42,"\u{1F4CA}"),t(),r(43," Export as CSV "),t()()(),C(44,"hr",18),i(45,"div",15)(46,"app-label"),r(47,"Import Data"),t(),i(48,"p",11),r(49," Import student records from a JSON file "),t(),i(50,"input",19,0),h("change",function(l){return d(o),p(a.handleFileSelect(l))}),t(),i(52,"app-button",20),h("onClick",function(){d(o);let l=F(51);return p(l.click())}),i(53,"span"),r(54,"\u{1F4E4}"),t(),r(55," Import from JSON "),t()(),C(56,"hr",18),i(57,"div",15)(58,"app-label",21),r(59,"Danger Zone"),t(),i(60,"p",11),r(61," Clear all student records from the application "),t(),i(62,"app-button",22),h("onClick",function(){return d(o),p(a.openClearDialog())}),i(63,"span"),r(64,"\u{1F5D1}\uFE0F"),t(),r(65," Clear All Data "),t()()()(),i(66,"app-card",23)(67,"app-card-header")(68,"app-card-title"),r(69,"About"),t(),i(70,"app-card-description"),r(71," Information about this application "),t()(),i(72,"app-card-content",24)(73,"div",25)(74,"div",26),r(75,"\u2139\uFE0F"),t(),i(76,"div")(77,"h3",27),r(78,"Student Records Management"),t(),i(79,"p",28),r(80," A simple, elegant application for managing engineering student records "),t(),i(81,"p",11),r(82," This application allows faculty to efficiently manage student data, including adding new students, editing existing records, and searching through the database. All data is stored locally in your browser. "),t()()()()()(),i(83,"app-alert-dialog",29),h("onConfirm",function(){return d(o),p(a.clearAllData())})("onCancel",function(){return d(o),p(a.cancelClearDialog())})("openChange",function(l){return d(o),p(a.onAlertDialogOpenChange(l))}),t()()}n&2&&(f(21),S("checked",a.themeService.currentTheme==="dark"),f(15),S("disabled",a.students.length===0),f(4),S("disabled",a.students.length===0),f(43),S("open",a.showClearDialog)("glassEffect",!0))},dependencies:[A,R,V,j,N,J,M,O,z,L],encapsulation:2})}}return c})();export{ne as SettingsComponent};
